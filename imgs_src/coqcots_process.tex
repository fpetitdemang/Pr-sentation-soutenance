%\tikzexternalenable
%\tikzsetnextfilename{graphicalabstract}
\begin{tikzpicture}[font=\small,thick,
     task/.style={align=flush center},
     point/.style={circle,inner sep=1pt,fill=orange},
     num/.style={draw,circle,inner sep=1pt,thin,font=\scriptsize},
     xscale=1.6
     ]
     \node[point] (dos) at (2.8,1.8) {};
     \draw[->] (.1,1.5) ..controls (.2,1.3) and (.4,1).. (.9,1) ..controls (1.5,1) and (1.7,1.8).. (dos);
     \node[right] (task1) at (.3,2) {extract architecture};
     \node[num,below=1pt] (1) at ([xshift=-1mm]task1.south) {1};

     \node[point,label={[text width=2.2cm,orange]0:reconfiguration proved correct}] (bouche) at (5.2,.1) {};

     \begin{scope}[decoration={gluon,aspect=-.8,segment length=6mm,amplitude=5mm}]
       \draw[decorate,->] (dos) -- node[coordinate] (m) {} (bouche);
     \end{scope}
     \coordinate (middle) at ([xshift=4mm,yshift=7mm]m);
     \node[text width=3.2cm,task,align=flush left,right,inner sep=0pt] (task2) at (middle) {model and prove reconfiguration until...};
     \node (2') at ([xshift=-1mm]middle) {\picturedactor{scale=.5, fill=white, draw=green!50!black, thick}};
     \node[num,left=1.5mm] (2) at (2') {2};

     \node[point] (ventre) at ([yshift=-3.6cm]dos) {};
     \path (bouche) to[bend left] node[point] (milieu) {} (ventre);
     \draw[->] (bouche) to[bend left,out=10,in=170] node[text width=2.6cm,task,align=flush left,below right,inner sep=0pt] (task4) {extract from Coq} node[coordinate] (middle) {} (milieu);
     \node[num,above left=2pt] (4) at (middle) {3};
     \draw[->] (milieu) to[bend left,out=10,in=160] node[text width=2.6cm,task,align=flush left,below right,inner sep=0pt] (task4) {develop DSU} node[coordinate] (middle) {} (ventre);
     \node (2') at ([xshift=-2mm]middle) {\picturedactor{scale=.5, fill=white, draw=green!50!black, thick}};
     \node[num,above=2pt] (4) at (middle) {4};

     \draw[->] (ventre) ..controls (1.7,-1.8) and (1.5,-1).. (.9,-1) ..controls (.4,-1) and (.2,-1.3).. (.1,-1.5);
     \node[right] (task5) at (.3,-2) {apply reconfiguration};
     \node[num,above=-1pt] at (task5.north-|1) {5};
      
     \draw[blue,->] (0,1.9) -- (0,-1.9) node[pos=.5,above,rotate=90,text width=3.8cm,text badly centered] {Pycots application executing};

     \begin{scope}[orange,thin]
       \draw[dashed,shorten >=-4mm,shorten <=-9mm] (dos) -- ($(dos)!0.5!(ventre)$) -- (milieu);
       \node[left=1mm] at ([yshift=-2mm]$(dos)!0.5!(ventre)$) {Pycots};
       \node[right=1mm] at ([yshift=2mm]$(dos)!0.5!(ventre)$) {Coqcots};
     \end{scope}

   \end{tikzpicture}
%\tikzexternaldisable

%% Local Variables:
%% mode: latex
%% TeX-master: "../main.tex"
%% End:
